<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1'>

	<!-- Primary Meta Tags -->
	<title>Dawid HuczyÅ„ski</title>
	<meta name="title" content="Dawid HuczyÅ„ski">
	<meta name="description" content="">

	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://dawid.huczynski.pl/">
	<meta property="og:title" content="Dawid HuczyÅ„ski">
	<meta property="og:description" content="">
	<meta property="og:image" content="https://dawid.huczynski.pl/images/wh-social.jpg">

	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://dawid.huczynski.pl/">
	<meta property="twitter:title" content="Dawid HuczyÅ„ski">
	<meta property="twitter:description" content="">
	<meta property="twitter:image" content="https://dawid.huczynski.pl/images/wh-social.jpg">

	<!-- Optional Additions for Consideration -->
	<meta property="og:site_name" content="Dawid HuczyÅ„ski">

	<!-- <link rel="icon" href="../images/favicon.ico" sizes="any"> -->
	<link rel="icon" href="../svg/logo-dh.svg" type="image/svg+xml">
	<!-- <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"> -->
	<link rel="manifest" href="../theme/manifest.webmanifest">
	<meta name="theme-color" content="#92ac41" />
	<!-- <link rel="preconnect" href="https://fonts.googleapis.com"> -->
	<!-- <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> -->
	<!-- <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500&display=swap" rel="stylesheet">  -->
	<!-- <link rel="stylesheet" href="leaflet.css" data-svelte="svelte-f6hidj"> -->


	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
	<!-- <link href="../theme/css/prism-material-light.css" rel="stylesheet" /> -->
	<link href="../theme/css/prism-gruvbox-dark.css" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="../theme/css/global.css" media="screen">

	<meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_page-d7be49ec.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Nav-4ff2e076.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-e2297e21.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-5cf732b6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-ca1e47c6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper-41c905a7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control-f5b05b5f.js">
		<link rel="modulepreload" href="../_app/immutable/components/layout.svelte-958a1762.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.js-eb00e147.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-dc735eee.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-cbc6a3fd.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/blog/_slug_/_layout.js-4ed993c7.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/blog/_slug_/_page.svelte-49a3c99e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Nav-cd4a338e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/formatDate-f375c276.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores-92482488.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/blog/_slug_/_page.js-11ed9821.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/dynamic-import-helper-be004503.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_page-50c75215.js"><title>
		Revit project geolocation and data scraping - Dawid HuczyÅ„ski
	</title><!-- HEAD_svelte-mdzxh8_START --><!-- HEAD_svelte-mdzxh8_END -->

	<!-- Statistics -->
	<!-- Umami -->
	<script async defer data-website-id="55055229-61bf-4885-99a6-985a9a75049b"
		src="https://stats.huczynski.pl/umami.js"></script>
	<!-- Plausible -->
	<script defer data-domain="dawid.huczynski.pl" src="https://stats2.huczynski.pl/js/script.js"></script>
	<!-- Matomo -->
	<script>
		var _paq = window._paq = window._paq || [];
		/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
		_paq.push(['trackPageView']);
		_paq.push(['enableLinkTracking']);
		(function () {
			var u = "//matomo.huczynski.pl/";
			_paq.push(['setTrackerUrl', u + 'matomo.php']);
			_paq.push(['setSiteId', '1']);
			var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
			g.async = true; g.src = u + 'matomo.js'; s.parentNode.insertBefore(g, s);
		})();
	</script>
	<!-- End Matomo Code -->

</head>

<body>
	<div>




<nav id="nav" class="svelte-jld698 top"><ul class="svelte-jld698"><li class="svelte-jld698"><a href="/#start" class="nav-link logo active svelte-jld698"><img alt="Logo" src="/svg/logo-dh.svg" class="svelte-jld698"></a></li>
		<li class="svelte-jld698"><a href="/#portfolio" class="nav-link svelte-jld698"><!-- HTML_TAG_START --><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.59 4.59C10.21 4.21 9.7 4 9.17 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-1.41-1.41z" /></svg><!-- HTML_TAG_END --></a></li>
		<li class="svelte-jld698"><a href="/#about" class="nav-link svelte-jld698"><!-- HTML_TAG_START --><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4z" /></svg><!-- HTML_TAG_END --></a></li>
		<li class="svelte-jld698"><a href="/#contact" class="nav-link svelte-jld698"><!-- HTML_TAG_START --><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z" /></svg><!-- HTML_TAG_END --></a></li>
		<li class="svelte-jld698"><a href="/blog" class="nav-link svelte-jld698"><!-- HTML_TAG_START --><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.39 7.1023-3.4925-3.4925 1.146-1.146c0.30923-0.30923 0.69122-0.46385 1.146-0.46385 0.45475 0 0.83674 0.15462 1.146 0.46385l1.2005 1.2005c0.30923 0.30923 0.46385 0.69122 0.46385 1.146 0 0.45475-0.15462 0.83674-0.46385 1.146zm-1.146 1.146-13.752 13.752h-3.4925v-3.4925l13.752-13.752z" /></svg><!-- HTML_TAG_END --></a></li></ul>
	<div class="submenu svelte-jld698 title"><a href="./" class="tt svelte-jld698">Blog</a></div>
</nav>
<section class="one-column blog-post svelte-1xpw61y"><header><h1 class="page-title">Revit project geolocation and data scraping</h1>
		<div class="author svelte-1xpw61y"><img src="/images/dh.webp" alt="Author" class="round-img svelte-1xpw61y">
			<p class="name svelte-1xpw61y">Dawid HuczyÅ„ski</p>
			<p class="svelte-1xpw61y">posted on 27 grudnia 2022</p></div>
		<p class="svelte-1xpw61y">Revit automation for project startup. Geolocalization, point cloud parsing, site data imports and more..</p></header>
	<h2>Wprowadzenie</h2>
<p>W tym poÅ›cie postaram siÄ™ wam przybliÅ¼yÄ‡ dane z jakimi moÅ¼ecie mieÄ‡ stycznoÅ›Ä‡, moÅ¼liwoÅ›ci ich przetwarzania i wykorzystania w projektowaniu budynkÃ³w, budowli oraz ich analiz. Na koniec pokaÅ¼Ä™ zarys jak moÅ¼na to zautomatyzowaÄ‡ w Revicie i Blenderze.</p>
<p>Ostatnimi czasy dane publiczne stajÄ… siÄ™ coraz bardziej dostÄ™pne. Instytucje rzÄ…dowe jak i amatorskie gromadzenie i analiza danych daje nam dostÄ™p do niesamowitych zasobÃ³w.
Wystarczy je przetworzyÄ‡ by mÃ³c stworzyÄ‡ warunki do projektowania niespotykane dotychczas w naszej branÅ¼y, bez wiÄ™kszych nakÅ‚adÃ³w pracy.</p>
<p>PamiÄ™tam czasy gdy analizÄ™ sÅ‚oÅ„ca byÅ‚a robiona za pomocÄ… specjalnej linijki nakÅ‚adanej na rzut. Unormowana praktyka posiadajÄ…ca niesamowitÄ… iloÅ›Ä‡ uproszczeÅ„. Potem przeszliÅ›my na analizy sÅ‚oÅ„ca 3D, tworzÄ…c nasz projekt w trzecim wymiarze i modelujÄ…c proste bryÅ‚y sÄ…siadÃ³w. Niekoniecznie sprawdzaliÅ›my czy program w ktÃ³rym pracujemy bierze pod uwagÄ™ odchylenia wzglÄ™dem przesuniÄ™Ä‡ UTC, czy bierze pod uwagÄ™ wysokoÅ›Ä‡ nad poziomem morza, czy liczy uproszczenie pÅ‚aszczyznowe, czy krzywizny ziemiâ€¦ ale na to moÅ¼e bÄ™dzie inny post.</p>
<p>PowyÅ¼szy przykÅ‚ad miaÅ‚ pokazaÄ‡, jakie moÅ¼liwoÅ›ci stojÄ… przed nami i jak szczegÃ³Å‚owo moÅ¼emy wchodziÄ‡ w analizy. OczywiÅ›cie, bardziej skomplikowane analizy wiÄ…Å¼Ä… siÄ™ z czasem na wprowadzenie/wymodelowanie potrzebnych danych.</p>
<h2>NMT, czyli Numeryczny Model Terenu, ale czy na pewno?</h2>
<p><img src="/images/blog/001-dem-switzerland.webp" alt="DEM Switzerland"></p>
<p>JesteÅ›my na etapie,/kiedy wiÄ™kszoÅ›Ä‡ danych geograficznych jest publicznie dostÄ™pna w internecie. ZaczÄ™Å‚o siÄ™ od DEMâ€™Ã³w (Digital Elevation Model). ZdjÄ™Ä‡ satelitarnych odzwierciedlajÄ…cych wysokoÅ›ci terenu. Kiedy zaczynaÅ‚em siÄ™ tym interesowaÄ‡ byÅ‚y to skale dosyÄ‡ trudne, poniewaÅ¼ jeden pixel informacji pokrywaÅ‚ ok 30m2 terenu. Potem zeszÅ‚o to do 10m2. Z takich informacji moÅ¼na byÅ‚o juÅ¼ wyciÄ…gaÄ‡ caÅ‚kiem ciekawe uproszczenie terenu, bez dodatkowych opÅ‚at.
Tutaj moÅ¼na daÄ‡ przykÅ‚ad:</p>
<ul><li>ALOS World 3D - 30m</li>
<li>NASADEM Global Digital Elevation Model</li>
<li>USGS 1/3 arc-second Digital Elevation Model - 10m szczegÃ³Å‚owoÅ›ci
W pewnym momencie zaczÄ™Å‚y powstawaÄ‡ bazy danych, gdzie za pomocÄ… zapytaÅ„ moÅ¼na byÅ‚o pobieraÄ‡ wysokoÅ›Ä‡ nad poziomem morza. Takie strony jak:</li>
<li><a href="https://www.opentopography.org/" rel="nofollow">https://www.opentopography.org/</a></li>
<li><a href="https://open-elevation.com/" rel="nofollow">https://open-elevation.com/</a></li>
<li>czy nawet api google maps z informacjami o wysokoÅ›ci terenu npm.</li></ul>
<p>Obecnie DEMâ€™y moÅ¼na spotkaÄ‡ nawet w szczegÃ³Å‚owoÅ›ci co 1m. Pozytywnym przykÅ‚adem moÅ¼e byÄ‡ udostÄ™pnione przez PolskÄ™ paczki wysokoÅ›ciowe pokrywajÄ…ce caÅ‚e terytorium Polski z punktami rozstawionymi co 1m. DEMâ€™y moÅ¼na podzieliÄ‡ na parÄ™ rodzajÃ³w:</p>
<ul><li>raster</li>
<li>grid</li></ul>
<p>Pierwszy to np. obrazy .tiff gdzie odcieÅ„ szaroÅ›ci definiuje wysokoÅ›Ä‡. Ograniczeniem jest tu wymiar jednego pixela (np. 30m, 10m, 1m). Przetwarzanie takich danych wymaga np. darmowego oprogramowania jak <strong>QGIS</strong>. QGIS pozwala zaÅ‚adowaÄ‡ takiego tiffa w odpowiednich koordynatach, przyciÄ…Ä‡ go do potrzebnych nam zakresÃ³w, a potem wygenerowaÄ‡ z danych rastrowych np. poziomice, siatkÄ™ punktÃ³w. Grid to oczywiÅ›cie plik np. plik tekstowy z listÄ… liczb, ktÃ³re sÄ… definiujÄ… wysokoÅ›Ä‡ nad poziomem terenu na siatce co 1m.
Å»eby uÅ¼yÄ‡ tego np, w Revicie trzeba przekonwertowaÄ‡ takie dane na plik csv z kolumnami X, Y, Z. To pozwoli nam zaimportowaÄ‡ je jako toposurface.</p>
<p>Ale czy to na pewno jest juÅ¼ granica szczegÃ³Å‚owoÅ›ci? OczywiÅ›cie, Å¼e nie. ğŸ˜‰</p>
<h2>Chmura punktÃ³w</h2>
<p>Kolejnym poziomem szczegÃ³Å‚owoÅ›ci w moim przekonaniu sÄ… surowe dane pomiarowe. WczeÅ›niej byÅ‚y to rzesze geodetÃ³w i zaawansowane technologie triangulacji. Teraz teÅ¼ opiera siÄ™ to o triangulacjÄ™. Tylko iloÅ›Ä‡ danych wzrosÅ‚a wykÅ‚adniczo. Mowa o chmurach punktÃ³w.
Tutaj moÅ¼emy sprawdzaÄ‡ dokÅ‚adnoÅ›Ä‡ z marginesem bÅ‚Ä™du do paru centymetrÃ³w, lub jak kto woli przy danych lidar z drona lotniczego to na przykÅ‚adzie geoportalu, ktÃ³ry mÃ³wi o szczegÃ³Å‚owoÅ›ci od 4 punktÃ³w/m2 do aÅ¼ 20 punktÃ³w /m2 w przypadku wiÄ™kszych miast, przy Å›rednim bÅ‚Ä™dzie wysokoÅ›ci np. do 10cm.</p>
<p>Tutaj znÃ³w podam przykÅ‚ad polskiego ministerstwa, ktÃ³re udostÄ™pnia dane pomiarowe (lidar) w formacie las.
Chmura punktÃ³w to coÅ› na ksztaÅ‚t obrazka w 3 wymiarach. Zamiast pixeli mamy punkty w 3D. KaÅ¼dy z punktÃ³w moÅ¼e mieÄ‡ dodatkowe parametry jak:</p>
<ul><li>kolor</li>
<li>klasyfikacjÄ™ - czy jest to budynek, zieleÅ„ niska, wysoka, teren, samochÃ³d, lampa ulicznaâ€¦</li>
<li>dokÅ‚adnoÅ›Ä‡ - jak precyzyjny byÅ‚ pomiar tego punktu</li>
<li>intensywnoÅ›Ä‡ - intensywnoÅ›Ä‡ odbicia wiÄ…zki lidar</li>
<li>oraz wiele innych danych bezpoÅ›rednich</li>
<li>dodatkowo dane poÅ›rednie wynikajÄ…ce z analizy punktÃ³w i ich relacji wzglÄ™dem siebie np.:<ul><li>czy punkty sÄ… na jednej pÅ‚aszczyÅºnie - moÅ¼e byÄ‡ to Å›ciana?</li>
<li>czy punkty nie majÄ… Å¼adnej pÅ‚aszczyzny a sÄ… w grupie - moÅ¼e to drzewo?</li></ul></li></ul>
<p>To juÅ¼ jest olbrzymia iloÅ›Ä‡ danych z ktÃ³rej moÅ¼emy korzystaÄ‡. W geoportalu nazywa siÄ™ to Dane Pomiarowe, ja bÄ™dÄ™ uÅ¼ywaÅ‚ uogÃ³lnienia, czyli chmura punktÃ³w.
Chmury moÅ¼emy podzieliÄ‡, na przerÃ³Å¼ny sposÃ³b i w rÃ³Å¼ne grupy, ja skupiÄ™ siÄ™ na praktycznym podziale:</p>
<ul><li>chmury punktÃ³w lidar</li>
<li>chmury punktÃ³w fotogrametrii</li></ul>
<p>oraz innym:</p>
<ul><li>chmury punktÃ³w sklasyfikowane</li>
<li>chmury punktÃ³w niesklasyfikowane</li></ul>
<p>Na koniec moÅ¼na dodaÄ‡, Å¼e chmury mogÄ… teÅ¼ byÄ‡:</p>
<ul><li>zarejestrowane,</li>
<li>niezarejestrowane.</li></ul>
<p>JeÅ¼eli sÅ‚yszycie to pojÄ™cie to gÅ‚Ã³wnie chodzi o ustawienie takiej chmury w konkretnych ukÅ‚adach wspÃ³Å‚rzÄ™dnych pionowych i poziomych, oraz wyczyszczenie i poprawienie ich z niedociÄ…gniÄ™Ä‡ i bÅ‚Ä™dnych pomiarÃ³w. Czyli w uproszczeniu geolokalizacja.</p>
<p>Polski geoportal najczÄ™Å›ciej dostarcza nam w peÅ‚ni scalone dane pomiarowe zawierajÄ…ce podstawowe potrzebne informacje:</p>
<ul><li>geolokalizacjÄ™</li>
<li>kolor</li>
<li>klasyfikacjÄ™</li></ul>
<p>DziÄ™ki temu moÅ¼emy Å‚atwo i szybko dopracowaÄ‡ takÄ… chmurÄ™ do potrzeb projektowych.</p>
<ul><li>WyfiltrowaÄ‡ wszystkie budynki i wrzuciÄ‡ je na osobnÄ… warstwÄ™, do pomiarÃ³w sÄ…siadÃ³w</li>
<li>WyfiltrowaÄ‡ teren i wygenerowaÄ‡ z niego teren 3D (np. revitowÄ… toposurface)</li>
<li>WyfiltrowaÄ‡ zieleÅ„ wysokÄ…, przetworzyÄ‡ dane i sprawdziÄ‡ gdzie sÄ… wierzchoÅ‚ki drzew(co za tym idzie ich lokalizacja)</li>
<li>Za pomocÄ… darmowych narzÄ™dzi moÅ¼emy wyfiltrowaÄ‡ wszystkie punkty leÅ¼Ä…ce w granicach naszej dziaÅ‚ki i usunÄ…Ä‡ z niej wszystko poza punktami terenu, resztÄ™ chmury zostawiajÄ…c w spokoju.</li></ul>
<p>Do tych zadaÅ„ idealnie nadaje siÄ™ narzÄ™dzie <strong>CloudCompare</strong>. Potrafi otwieraÄ‡ chmury punktÃ³w z zachowaniem ukÅ‚adu odniesienia, czyÅ›ciÄ‡, analizowaÄ‡ i przetwarzaÄ‡ dane. Dodatkowo ma podstawowe moÅ¼liwoÅ›ci klasyfikacji punktÃ³w. Z zalet tego programu, ktÃ³re przydajÄ… siÄ™ w procesie projektowym wymieniÅ‚bym gÅ‚Ã³wnie:</p>
<ul><li>moÅ¼liwoÅ›Ä‡ klasyfikacji punktÃ³w terenu (jeÅ¼eli nie ma klasyfikacji)</li>
<li>moÅ¼liwoÅ›Ä‡ nakÅ‚adania kolorÃ³w z zdjÄ™Ä‡ satelitarnych na chmurÄ™ punktÃ³w (jeÅ¼eli brakuje kolorÃ³w)</li>
<li>rejestracjÄ™ chmur punktÃ³w wzglÄ™dem siebie</li></ul>
<p>Takie ruchy pozwolÄ… nam podzieliÄ‡ chmurÄ™ punktÃ³w na lekkie paczki, ktÃ³re moÅ¼na potem podlinkowaÄ‡ w pliku Revitowym i mieÄ‡ kontrolÄ™ nad widocznoÅ›ciÄ… wszystkiego. Tutaj niestety nie obejdzie siÄ™ bez pÅ‚atnego programu Autodesk Recap, ktÃ³ry otwiera pliki <code>.las</code> i zapisuje je do formatu <code>.rcp</code>, ktÃ³ry moÅ¼na podczytaÄ‡ w Revicie.</p>
<p>Z tak zaÅ‚adowanÄ… chmurÄ…, moÅ¼emy jÄ… podczytaÄ‡ w odpowiednich koordynatach do naszego projektu i moÅ¼emy byÄ‡ pewni, Å¼e punkty siedzÄ… idealnie w terenie. Z praktyki mogÄ™ powiedzieÄ‡, Å¼e taka chmura Å›wietnie siÄ™ sprawdza na etapie koncepcji i projektowaniu w kontekÅ›cie terenu z <strong>rzeczywistymi (!!!)</strong> obiektami terenu jak zieleÅ„, cieki, budynki, drogi, wzniesienia, rzeÅºby (nie ma co wymieniaÄ‡, bo to jest dosÅ‚ownie wszystko). Przydaje siÄ™ do uszczegÃ³Å‚awiania i modelowania dachÃ³w budynkÃ³w sÄ…siednich, lub sprawdzania rzeczywistej wysokoÅ›ci attyk i wysokoÅ›ci. Åšwietnie siÄ™ sprawdza rÃ³wnieÅ¼ w przypadku wizualizacji. Generowania rzeczywistego terenu i analizy wykopÃ³w mas ziemnych.</p>
<h2>Granice dziaÅ‚ek</h2>
<p>RÃ³Å¼ne kraje majÄ… rÃ³Å¼ne bazy dostÄ™pnych publicznie danych. Jako przykÅ‚ad moÅ¼na podaÄ‡ usÅ‚ugi</p>
<ul><li>WMS (Web Map Service) WMTS (Web Map Tile Service),</li>
<li>WFS (Web Feature Service),</li>
<li>ATOM,</li>
<li>INSPIRE (Infrastructure for Spatial Information in Europe).</li></ul>
<p>SÄ… to ujednolicone usÅ‚ugi udostÄ™pniania danych geograficznych jak ortofotomapy, granice, plany miejscowe i wiele innych.</p>
<p>Polski Geoportal pozwala na pobranie bazy BDOT10k (Baza Danych ObiektÃ³w Topograficznych), z ktÃ³rych za pomocÄ… znanego nam QGIS moÅ¼emy wyciÄ…gnÄ…Ä‡ np. granice dziaÅ‚ek, lub obrysy istniejÄ…cych budynkÃ³w, osie drÃ³g oraz wiele innych informacji, jak punkty lokalizacji przystankÃ³w, rodzaje terenÃ³w etc. Takie dane moÅ¼emy potem zaimportowaÄ‡ do programÃ³w projektowych 2D lub 3D.</p>
<p>QGIS pozwala nam to wizualnie wyfiltrowaÄ‡ oraz ustawiÄ‡ w odpowiednich koordynatach.
Tzw. Reprojection z ogÃ³lnopolskiego ukÅ‚adu wspÃ³Å‚rzÄ™dnych na ukÅ‚ad, w ktÃ³rym projekt jest opracowywany. A o tym w nastÄ™pnym podpunkcie.
Pod <a href="https://www.geoportal.gov.pl/uslugi/usluga-przegladania-wms" rel="nofollow">tym linkiem</a> widaÄ‡ jakie usÅ‚ugi sÄ… dostÄ™pne w ramach WMS geoportalu.pl</p>
<h2>Geolokalizacja i numery EPSG</h2>
<p><img src="/images/blog/001-poland-epsg.gif" alt="Map of Poland EPSG 3857" title="EPSG 3857">
Od tego tematu powinniÅ›my zaczÄ…Ä‡, ale zawsze lepiej zaczÄ…Ä‡ od czegoÅ› bardziej efektownego. EPSG natomiast to element ukÅ‚adanki, ktÃ³ry poÅ‚Ä…czy wszystko w caÅ‚oÅ›Ä‡. ZnajomoÅ›Ä‡ tego pojÄ™cia uÅ‚atwi nam pracÄ™, wyeliminuje podstawowe bÅ‚Ä™dy i przy prawie zerowym nakÅ‚adzie pracy wprowadzi pierwszÄ… automatyzacjÄ™ procesÃ³w.</p>
<p>Kody EPSG powstaÅ‚y w celu standaryzacji nazewnictwa ukÅ‚adÃ³w wspÃ³Å‚rzÄ™dnych. W te kody wchodzÄ… ukÅ‚ady wspÃ³Å‚rzÄ™dnych prostokÄ…tnych pÅ‚askich (rzutowania) jak i geograficznych.
W polsce mamy dwa systemy ukÅ‚adÃ³w odniesienia PL-ETRF2000 oraz aktualny <code>PL-ETRF89</code>.</p>
<p>UkÅ‚ad wspÃ³Å‚rzÄ™dnych pÅ‚askich prostokÄ…tnych PL-200 razem z numerami EPSG to:</p>
<table><thead><tr><th>EPSG</th>
<th>PL2000</th>
<th>PoÅ‚udnik</th></tr></thead>
<tbody><tr><td>EPSG:2180</td>
<td>PL2000</td>
<td>caÅ‚a polska</td></tr>
<tr><td>EPSG:2176</td>
<td>PL2000/5</td>
<td>15</td></tr>
<tr><td>EPSG:2177</td>
<td>PL2000/6</td>
<td>18</td></tr>
<tr><td>EPSG:2178</td>
<td>PL2000/7</td>
<td>21</td></tr>
<tr><td>EPSG:2179</td>
<td>PL2000/8</td>
<td>24</td></tr></tbody></table>
<p>Wiedza o tym w jakim ukÅ‚adzie znajduje siÄ™ dziaÅ‚ka, lub w jakim ukÅ‚adzie mamy dane pozwoli nam w bezproblemowy sposÃ³b scaliÄ‡ takie dane. Do analizy i przetwarzania takich danych teÅ¼ najlepiej sprawdzi siÄ™ <strong>QGIS</strong>. CzÄ™sto zdarzy siÄ™, Å¼e chmura punktÃ³w dostarczana jest w ukÅ‚adzie ogÃ³lnopolskim, a projekt ustawiony jest w koordynatach szczegÃ³Å‚owych np. strefy 6.</p>
<h2>Modele BudynkÃ³w</h2>
<p>W temacie budynkÃ³w bÄ™dziemy mieli parÄ™ opcji generowania modeli 3D.
Pierwsza, Å‚atwiejsza i czasochÅ‚onna opcja, to znalezienie istniejÄ…cych modeli i ustawianie ich w 3D do granic budynkÃ³w pozyskanych z usÅ‚ug WFS. OczywiÅ›cie jest to oczywista opcja, ale warto jÄ… zawrzeÄ‡, bo czasem, moÅ¼na natknÄ…Ä‡ siÄ™ na bardzo dokÅ‚adne modele obiektÃ³w.</p>
<p>DrugÄ… opcjÄ… jest pozyskanie danych z geoportalu. Budynki moÅ¼na pobraÄ‡ w formacie GML w szczegÃ³Å‚owoÅ›ci LOD1. Aby mÃ³c je wykorzystaÄ‡ w revicie lub innym programie trzeba je przerobiÄ‡ na natywny format. Dla revita bÄ™dzie to najlepiej <code>MASS FAMILY</code>. Dla blendera np. <code>OBJ</code>. Plik GML ma strukturÄ™ XML, wiÄ™c moÅ¼emy go odczytaÄ‡ w pythonie  za pomocÄ… parser xml wyglÄ…daÅ‚oby to tak:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token comment"># python</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> xml<span class="token punctuation">.</span>etree <span class="token keyword">import</span> ElementTree <span class="token keyword">as</span> et

FILEPATH <span class="token operator">=</span> <span class="token string">"file.gml"</span>


<span class="token keyword">def</span> <span class="token function">unflatten</span><span class="token punctuation">(</span>coords<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""gets numbers list
    returns array of points (XYZ)"""</span>
    verts <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>coords<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> s<span class="token punctuation">,</span> coords<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> s<span class="token punctuation">,</span> coords<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> s<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>coords<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> verts


tree <span class="token operator">=</span> et<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>FILEPATH<span class="token punctuation">)</span>
polygons <span class="token operator">=</span> tree<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">".//&#123;http://www.opengis.net/gml&#125;Polygon"</span><span class="token punctuation">)</span>
verts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
faces <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> p <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>polygons<span class="token punctuation">)</span><span class="token punctuation">:</span>
    poslist <span class="token operator">=</span> p<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">".//&#123;http://www.opengis.net/gml&#125;posList"</span><span class="token punctuation">)</span>
    text <span class="token operator">=</span> poslist<span class="token punctuation">.</span>text
    coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    points <span class="token operator">=</span> unflatten<span class="token punctuation">(</span>coords<span class="token punctuation">)</span>
    start_idx <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>verts<span class="token punctuation">)</span>
    end_idx <span class="token operator">=</span> start_idx <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span>

    verts<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>points<span class="token punctuation">)</span>
    faces<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_idx<span class="token punctuation">,</span> end_idx<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code><!-- HTML_TAG_END --></pre>
<p>Co daÅ‚oby nam zbiÃ³r wierzchoÅ‚kÃ³w i poligonÃ³w (grupy wierzchoÅ‚kÃ³w ktÃ³re tworzÄ… pojedyncze poligony). Z takiego formatu bardzo Å‚atwo juÅ¼ wygenerowaÄ‡ obiekt w Blenderze, zapisaÄ‡ jako OBJ i zaimportowaÄ‡ do Revita. Lub za pomocÄ… Revit API automatycznie wymodelowaÄ‡ obiekty MASS za pomocÄ… tych danych. Plusem tego rozwiÄ…zania jest to, Å¼e takie budynki sÄ… juÅ¼ zlokalizowane w ukÅ‚adzie poziomym i pionowym.</p>
<hr>
<blockquote><h3>Problem dalekich odlegÅ‚oÅ›ci<br></h3>
<p>Pojawia siÄ™ jeden problem dosyÄ‡ znany w Å›rodowiskach grafikÃ³w 3D. Im dalej wierzchoÅ‚ek jest poÅ‚oÅ¼ony od punktu [0,0,0] jego wyÅ›wietlanie siÄ™ zaczyna byÄ‡ coraz bardziej â€œprzybliÅ¼oneâ€. Jest to problem radzenia sobie komputerÃ³w z liczbami po przecinku. Komputer zawsze uogÃ³lnia liczby po przecinku do swojej interpretacji dlatego czasami moÅ¼e siÄ™ zdarzyÄ‡, Å¼e np. porÃ³wnujÄ…c liczby 0,003 == 0,003 okaÅ¼e siÄ™, Å¼e sÄ… rÃ³Å¼ne, poniewaÅ¼ dla komputera 0,003 = 0,003000000000000001. RozwiÄ…zaniem tego problemu byÅ‚oby pobranie informacji o lokalizacji <code>internal origin</code> lub <code>project base point</code> i przesuniÄ™cie wszystkich wierzchoÅ‚kÃ³w o dany wektor, aby wstawiaÅ‚y siÄ™ nie poprzez <strong>shared coordinates</strong>, a poprzez bliÅ¼szy punkt wstawienia.</p></blockquote>
<hr>
<p>Ostatnim rozwiÄ…zaniem jakie mÃ³gÅ‚bym zaproponowaÄ‡ wymaga trochÄ™ wiÄ™cej wiedzy technicznej, ale jest najdokÅ‚adniejsze. GeometriÄ™ budynkÃ³w moglibyÅ›my wygenerowaÄ‡ z chmury punktÃ³w. Na pomoc przychodzi tutaj sporo algorytmÃ³w do analiz przestrzennych, ale w skrÃ³cie myÅ›lowym moÅ¼emy to rozdzieliÄ‡ na poniÅ¼sze zadania:</p>
<ul><li>wydzielamy z chmury punktÃ³w punkty klasyfikowane jako budynki.</li>
<li>analizujemy ktÃ³re punkty naleÅ¼Ä… do jakich pÅ‚aszczyzn i dzielimy je na grupy na jakich siÄ™ te pÅ‚aszczyzny znajdujÄ…</li>
<li>majÄ…c pÅ‚aszczyzny i punkty naleÅ¼Ä…ce do pÅ‚aszczyzn wyszukujemy punkty graniczne ( leÅ¼Ä…ce na krawÄ™dziach kaÅ¼dej z grup). DziÄ™ki temu mamy przybliÅ¼one krawÄ™dzie danego obiektu i pÅ‚aszczyzny.</li>
<li>czyÅ›cimy punkty ktÃ³re leÅ¼Ä… na jednej prostej lub w jakiejÅ› maÅ‚ej odlegÅ‚oÅ›ci od niej. ZostajÄ… nam wtedy wierzchoÅ‚ki</li>
<li>Å‚Ä…czymy wierzchoÅ‚ki ktÃ³re leÅ¼Ä… blisko siebie nadajemy im numer i przypisujemy do pÅ‚aszczyzn.</li>
<li>finalny wynik daje nam te same zbiory wierzchoÅ‚kÃ³w i poligonÃ³w jak we wczeÅ›niejszym skrypcie.</li></ul>
<p>Ta  opcja daje nam duÅ¼o bardziej szczegÃ³Å‚owe budynki. JeÅ¼eli brakuje nam szczegÃ³Å‚owoÅ›ci, wÃ³wczas moÅ¼emy uÅ¼yÄ‡ lidar, drona lub aparatu lub smartfonu, aby wygenerowaÄ‡ dodatkowe chmury punktÃ³w za pomocÄ… np. darmowego oprogramowania do fotogrametrii Meshroom [1]. MajÄ…c chmurÄ™ punktÃ³w moÅ¼emy jÄ… poÅ‚Ä…czyÄ‡ z chmurÄ… dostarczonÄ… z geoportalu, zagÄ™szczajÄ…c dokÅ‚adnoÅ›Ä‡ i uzupeÅ‚niajÄ…c braki. Takie poÅ‚Ä…czenie chmury bez koordynatÃ³w z chmurÄ… z koordynatami nazywamy rejestracjÄ… chmury. ÅÄ…czy siÄ™ to teÅ¼ z wyczyszczeniem takiej chmury z bÅ‚Ä™dnych pomiarÃ³w. DziÄ™ki temu moÅ¼emy</p>
<p>[1]: Meshroom - program do generowania chmury punktÃ³w ze zdjÄ™Ä‡.</p>
<p>[1]: Fotogrametria - dziedzina zajmujÄ…ca siÄ™ przetwarzaniem zdjÄ™Ä‡ z aparatÃ³w i smartfonÃ³w na chmurÄ™ punktÃ³w.</p>
<h2>ZdjÄ™cia satelitarne</h2>
<p>Czy uwierzycie jeÅ¼eli wam powiem, Å¼e jest taki format zapisu obrazu, ktÃ³ry pozwala na geolokalizacjÄ™ tego obrazu w koordynatach? WyobraÅºcie sobie, Å¼e dostajecie mapÄ™ planu miejscowego / skan mapy do celÃ³w opiniodawczych od inwestora / zdjÄ™cie satelitarne dziaÅ‚ki lub dowolnÄ… innÄ… mapÄ™. Wrzucacie jÄ… do waszego programu i zawsze wkleja siÄ™ idealnie we wÅ‚asciwe miejsce? Idealnie w skali? Bez Å¼adnych znieksztaÅ‚ceÅ„?</p>
<p>Tak jest to moÅ¼liwe, nie zawsze, nie dla wszystkich programÃ³w, ale jest moÅ¼liwy zapis geolokalizacji dla obrazu. MoÅ¼emy to zrobiÄ‡ np. dla plikÃ³w PDF, lub TIFF. Takie pliki tiff nazywamy wtedy GeoTiff.</p>
<p>Kiedy pobieracie najczeÅ›ciej zdjÄ™cie satelitarne z portalu rzÄ…dowego, to ma ono juÅ¼ ustawione swoje koordynaty i system w jakim zostaÅ‚ zapisany. WrzucajÄ…c takiego tiffâ€™a np. do programu QGIS wystarczy mu ustawiÄ‡ w jakim ukÅ‚adzie zostaÅ‚ zapisany (np. EPSG:2180) i od razu wkleja siÄ™ we wÅ‚aÅ›ciwe miejsce. Bez Å¼adnych znieksztaÅ‚ceÅ„, bez przesuniÄ™Ä‡. Idealnie.</p>
<p>Drugim atutem satelity sÄ… dane. Dla nas moÅ¼e byÄ‡ przydatny kolor. W przypadku chmury punktÃ³w, ktÃ³ra nie ma zapisanych danych kolorystycznych moÅ¼emy przeÅ‚oÅ¼yÄ‡ kolory ze zdjÄ™cia satelitarnego na danÄ… chmurÄ™ punktÃ³w. TakÄ… moÅ¼liwoÅ›Ä‡ daje np. Cloud Compare.</p>
<h2>Joining it together + Automation</h2>
<p>Najciekawszym elementem tej ukÅ‚adanki jest to, Å¼e wiÄ™kszoÅ›Ä‡ tych zadaÅ„ moÅ¼na skrÃ³ciÄ‡ do jednego przycisku np. w Revicie. Potrzebujemy wprowadziÄ‡ tylko parÄ™ parametrÃ³w:</p>
<ul><li>lokalizacjÄ™ (koordynaty)</li>
<li>promieÅ„ widocznoÅ›ci (w jakim zasiÄ™gu pobieraÄ‡ dane) </li>
<li>opcjonalnie poligon/region z granicami dziaÅ‚ki</li></ul>
</section>


		<script type="module" data-sveltekit-hydrate="q7w0kx">
			import { start } from "../_app/immutable/start-e2297e21.js";

			start({
				env: {},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="q7w0kx"]').parentNode,
				version: "1673451938460",
				hydrate: {
					node_ids: [0, 2, 5],
					data: [null,null,null],
					form: null
				}
			});
		</script>
	</div>
	<hr>
	<footer>
		Copyright 2023, Dawid HuczyÅ„ski<br>Made with <a href="https://kit.svelte.dev/" target="_blank"
			rel="noopener noreferrer">SvelteKit</a>
	</footer>
</body>

</html>